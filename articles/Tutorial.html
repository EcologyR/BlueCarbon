<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tutorial • BlueCarbon</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BlueCarbon</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Tutorial.html">Tutorial</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EcologyR/BlueCarbon/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EcologyR/BlueCarbon/blob/master/vignettes/articles/Tutorial.Rmd" class="external-link"><code>vignettes/articles/Tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>Tutorial.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EcologyR/BlueCarbon" class="external-link">BlueCarbon</a></span><span class="op">)</span></span></code></pre></div>
<p>In this vignette we will use the example data from the BlueCarbon
library to estimate the organic carbon stocks in the first 75 cm and 1
meter of the soil and the average organic carbon sequestration rates of
these soils in the last 100 and 200 years.</p>
<div class="section level2">
<h2 id="load-example-data">Load example data<a class="anchor" aria-label="anchor" href="#load-example-data"></a>
</h2>
<p>The first dataframe (<a href="https://ecologyr.github.io/BlueCarbon/reference/core_comp.html"><code>core_comp</code></a>)
has field measurement data that we will use to estimate soil compaction
at core collection.</p>
<p>The second dataframe (<a href="https://ecologyr.github.io/BlueCarbon/reference/bluecarbon_data.html"><code>bluecarbon_data</code></a>)
has core field information and laboratory data that we will use to
correct core compaction, estimate organic carbon content in each sample
from organic matter content, and to estimate the organic carbon stocks
and sequestration rates.</p>
<p>The core field information and laboratory data includes: sampling
site, core ID, blue carbon ecosystem, dominant species, core compaction
percentage, sample minimum depth, sample maximum depth, dry bulk
density, organic matter content and (if available) organic carbon
content and sample age.</p>
</div>
<div class="section level2">
<h2 id="core-compaction-estimation">Core compaction estimation<a class="anchor" aria-label="anchor" href="#core-compaction-estimation"></a>
</h2>
<p>Many field methods to extract soil cores can lead to the compaction
of the material retrieved (e.g. manual percussion).</p>
<p><img src="images/compaction-01.png" width="497"></p>
<p>The compaction percentage can be estimated knowing the difference
between the original surface level of the soil and the surface level of
the soil within the sampler after core insertion and before
retrieval.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compaction</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_compaction.html">estimate_compaction</a></span><span class="op">(</span><span class="va">core_comp</span>,</span>
<span>                                  core <span class="op">=</span> <span class="st">"core"</span>,</span>
<span>                                  sampler_length <span class="op">=</span> <span class="st">"sampler_length"</span>,</span>
<span>                                  internal_distance <span class="op">=</span> <span class="st">"internal_distance"</span>,</span>
<span>                                  external_distance <span class="op">=</span> <span class="st">"external_distance"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in estimate_compaction(core_comp, core = "core", sampler_length =</span></span>
<span><span class="co">#&gt; "sampler_length", : Removing cores with missing data: Sm_03_04</span></span></code></pre></div>
<p>We got a warning about one core, core Sm_03_04, that has been removed
from the final dataframe, as there was missing data. We can look at this
core in the example data to see which data was missing.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">core_comp</span><span class="op">[</span><span class="va">core_comp</span><span class="op">$</span><span class="va">core</span><span class="op">==</span><span class="st">"Sm_03_04"</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;        core sampler_length internal_distance external_distance</span></span>
<span><span class="co">#&gt; 30 Sm_03_04             NA                NA                NA</span></span></code></pre></div>
<p>In this case, core Sm_03_04 didn’t have data about any of the three
variables needed. This are the first 10 rows of the resulting dataframe,
including a column with the core compaction percentages.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">compaction</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;        core sampler_length internal_distance external_distance compaction</span></span>
<span><span class="co">#&gt; 1  Sg_01_01            200                35                25   5.714286</span></span>
<span><span class="co">#&gt; 2  Sg_01_02            200                45                35   6.060606</span></span>
<span><span class="co">#&gt; 3  Sg_01_03            200                86                76   8.064516</span></span>
<span><span class="co">#&gt; 4  Sg_02_01            200                10                 0   5.000000</span></span>
<span><span class="co">#&gt; 5  Sg_02_02            200                60                50   6.666667</span></span>
<span><span class="co">#&gt; 6  Sg_02_03            200                78                68   7.575758</span></span>
<span><span class="co">#&gt; 7  Sg_03_01            200                52                42   6.329114</span></span>
<span><span class="co">#&gt; 8  Sg_03_02            200                 1                 1   0.000000</span></span>
<span><span class="co">#&gt; 9  Sg_03_03            200                98                78  16.393443</span></span>
<span><span class="co">#&gt; 10 Sg_04_01            200                21                 1  10.050251</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="decompact-cores">Decompact cores<a class="anchor" aria-label="anchor" href="#decompact-cores"></a>
</h2>
<p>Core compaction does not affect the final stock of the core. However,
it does affect the depth of the core samples. As stocks are given until
a known soil depth (e.g. the first meter) to be able to compare among
areas, the depth of the samples is needed to properly estimate the final
stock.</p>
<p>We use function <code><a href="../reference/decompact.html">decompact()</a></code> to estimate the decompacted
minimum and maximum depth of each sample before stock estimation.
Furthermore, as compaction reduces the volume of the samples, dry bulk
density has to be corrected. This can be done by estimating the
corrected volume by: multiplying the corrected thickness of the sample
(corrected maximum depth - corrected minimum depth) by the area of the
core; or, if compacted dry bulk density is provided, function
<code><a href="../reference/decompact.html">decompact()</a></code> will correct it. To provide compacted dry bulk
density, the name of that column has to be specified in the function
parameter “dbd” as, by default, this parameter is NULL and the function
assumes that it was not provided.</p>
<p><code><a href="../reference/decompact.html">decompact()</a></code> has 6 parameters:</p>
<ul>
<li><p>“df”: data.frame with core properties</p></li>
<li><p>“core”: (character) Name of the column with the id of the core to
which the sample belongs</p></li>
<li><p>“compaction”: (character) Name of the column with core compaction
IN PERCENTAGE, as calculated with
<code><a href="../reference/estimate_compaction.html">estimate_compaction()</a></code>.</p></li>
<li><p>“mind”: (character) Name of the column with minimum depth of the
sample (depth at the top of the sample)</p></li>
<li><p>“maxd”: (character) Name of the column with maximum depth of the
sample (depth at the bottom of the sample)</p></li>
<li><p>“dbd”: (character) Name of the column with dry bulk
density</p></li>
</ul>
<p>Here we don’t need to specify the name of the columns as in the
example data the names are the same as the default names in the
function. But we DO need to specify the dry bulk density column name as
by default this argument is NULL.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bluecarbon_decompact</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decompact.html">decompact</a></span><span class="op">(</span><span class="va">bluecarbon_data</span>, dbd <span class="op">=</span> <span class="st">"dbd"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in decompact(bluecarbon_data, dbd = "dbd"): Setting compaction = 0 for</span></span>
<span><span class="co">#&gt; these cores: Sm_03_04, Sg_10_02, Sg_11_03, Sm_05_01, Sm_06_01</span></span></code></pre></div>
<p>The warning has given a list of cores that have no compaction
percentage data. The function assumes that these cores were not
compacted in the field and sets compaction to zero.</p>
<p>Here are the first 10 rows of the final dataframe, with corrected
minimum and maximum sample depth and dry bulk density.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bluecarbon_decompact</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="4%">
<col width="6%">
<col width="7%">
<col width="14%">
<col width="8%">
<col width="3%">
<col width="3%">
<col width="7%">
<col width="6%">
<col width="2%">
<col width="2%">
<col width="11%">
<col width="11%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">site</th>
<th align="left">core</th>
<th align="left">ecosystem</th>
<th align="left">species</th>
<th align="right">compaction</th>
<th align="right">mind</th>
<th align="right">maxd</th>
<th align="right">dbd</th>
<th align="right">om</th>
<th align="right">oc</th>
<th align="right">age</th>
<th align="right">mind_corrected</th>
<th align="right">maxd_corrected</th>
<th align="right">dbd_corrected</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.7352912</td>
<td align="right">6.554328</td>
<td align="right">NA</td>
<td align="right">8</td>
<td align="right">0.000000</td>
<td align="right">1.060606</td>
<td align="right">0.6932745</td>
</tr>
<tr class="even">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0.9754336</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">13</td>
<td align="right">1.060606</td>
<td align="right">2.121212</td>
<td align="right">0.9196945</td>
</tr>
<tr class="odd">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0.8698411</td>
<td align="right">7.382634</td>
<td align="right">NA</td>
<td align="right">15</td>
<td align="right">2.121212</td>
<td align="right">3.181818</td>
<td align="right">0.8201359</td>
</tr>
<tr class="even">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">1.0272564</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">22</td>
<td align="right">3.181818</td>
<td align="right">4.242424</td>
<td align="right">0.9685560</td>
</tr>
<tr class="odd">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">0.9307887</td>
<td align="right">8.026647</td>
<td align="right">NA</td>
<td align="right">29</td>
<td align="right">4.242424</td>
<td align="right">5.303030</td>
<td align="right">0.8776007</td>
</tr>
<tr class="even">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="right">1.4696196</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">35</td>
<td align="right">5.303030</td>
<td align="right">6.363636</td>
<td align="right">1.3856413</td>
</tr>
<tr class="odd">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">6</td>
<td align="right">7</td>
<td align="right">1.0500201</td>
<td align="right">7.349944</td>
<td align="right">NA</td>
<td align="right">38</td>
<td align="right">6.363636</td>
<td align="right">7.424242</td>
<td align="right">0.9900190</td>
</tr>
<tr class="even">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">0.7396556</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">44</td>
<td align="right">7.424242</td>
<td align="right">8.484849</td>
<td align="right">0.6973896</td>
</tr>
<tr class="odd">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="right">0.7380564</td>
<td align="right">9.431279</td>
<td align="right">NA</td>
<td align="right">46</td>
<td align="right">8.484849</td>
<td align="right">9.545454</td>
<td align="right">0.6958817</td>
</tr>
<tr class="even">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">9</td>
<td align="right">10</td>
<td align="right">0.6777988</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">51</td>
<td align="right">9.545454</td>
<td align="right">10.606061</td>
<td align="right">0.6390675</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="estimation-of-organic-carbon-from-organic-matter">Estimation of organic carbon from organic matter<a class="anchor" aria-label="anchor" href="#estimation-of-organic-carbon-from-organic-matter"></a>
</h2>
<p>There is a well-known linear relation between organic matter content
and organic carbon in soils. This correlation can change between
ecosystems and sampling sites due to changes in organic matter
composition among other factors. Therefore, it is recommended to
estimate this correlation for each batch of samples.</p>
<p>The <code><a href="../reference/estimate_oc.html">estimate_oc()</a></code> estimates the content of organic
carbon for those samples where there are no organic carbon values (but
there may be organic matter values). Estimation of organic carbon is
done by means of linear regressions on log(organic carbon) ~ log(organic
matter). The function returns an organic carbon value for each organic
matter value provided. If there is a value for organic carbon for that
sample it returns the same value; otherwise, it estimates organic carbon
from a model fitted to that site, or a model fitted to that species, or
else a model fitted to that ecosystem. If there are too few samples with
values of organic matter content to build a reliable model or the model
fit is too poor,<code><a href="../reference/estimate_oc.html">estimate_oc()</a></code> uses the equations in <a href="https://doi.org/10.1038/ngeo1477" class="external-link">Fourqurean et al. (2012)</a> for
seagrasses, <a href="https://doi.org/10.1038/s41597-023-02633-x" class="external-link">Maxwell
et al. (2023)</a> for salt marshes and Piñeiro-Juncal (in prep.) for
mangroves to estimate the organic carbon.</p>
<p>It is unlikely, but possible, that a model predicts higher organic
carbon than organic matter content. As this is not possible in nature,
the function will give a warning and it is recommended to discard that
model.</p>
<p>Fourqureanet al. (2012) Seagrass ecosystems as a globally significant
carbon stock. Nat. Geosci.5, 505–509. <a href="https://doi.org/10.1038/ngeo1477" class="external-link uri">https://doi.org/10.1038/ngeo1477</a></p>
<p>Maxwell et al. (2023) Global dataset of soil organic carbon in tidal
marshes.Sci.Data 10, 1–14.<a href="https://doi.org/10.1038/s41597-023-02633-x" class="external-link uri">https://doi.org/10.1038/s41597-023-02633-x</a></p>
<p>Piñeiro-Juncal et al. (in prep) Soil organic carbon preservation and
decay trends in tidal marsh, mangrove and seagrass blue carbon
ecosystems.</p>
<p>The function <code><a href="../reference/estimate_oc.html">estimate_oc()</a></code> has 7 parameters:</p>
<ul>
<li><p>“df”: A tibble or data.frame containing all the data. Must have
at least five columns (see arguments below).</p></li>
<li><p>“core”: (character) Name of the column with the id of the core to
which the sample belongs</p></li>
<li><p>“site”: (character) Name of the column reporting sample
site.</p></li>
<li><p>“ecosystem”: (character) Name of the column reporting ecosystem
type. To apply published equations for OC estimation, ecosystem names
should be either “Salt Marsh”, “Seagrass” or “Mangrove”.</p></li>
<li><p>“species”: (character) Name of the column reporting the main
species in the site.</p></li>
<li><p>“om”: (character) Name of the column reporting organic matter
values.</p></li>
<li><p>“oc”: (character) Name of the column reporting organic carbon
values.</p></li>
</ul>
<p>Here we don’t need to specify the name of the columns as in the
example data the names are the same as the default names.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oc_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_oc.html">estimate_oc</a></span><span class="op">(</span><span class="va">bluecarbon_decompact</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Warning in estimate_oc(bluecarbon_decompact): The following cores had samples</span></span>
<span><span class="co">#&gt; with organic carbon values below the organic carbon range used to built the</span></span>
<span><span class="co">#&gt; model: Sg_04_01, Sm_04_03, Sm_04_04, Sm_05_01</span></span>
<span><span class="co">#&gt; Warning in estimate_oc(bluecarbon_decompact): The following cores had samples</span></span>
<span><span class="co">#&gt; with organic carbon values above the organic carbon range used to built the</span></span>
<span><span class="co">#&gt; model: Sg_04_01, Sm_03_01, Sm_04_02, Sm_04_03, Sm_04_04, Sm_05_01</span></span></code></pre>
<p>The <code><a href="../reference/estimate_oc.html">estimate_oc()</a></code> function produces a plot showing the
relationship between organic matter and organic carbon content, and will
provide warnings if any of the samples had organic matter contents
outside the percentage of organic carbon in the samples used to estimate
the models.</p>
<p>The function returns a list with two elements: [1] the original
dataframe with three new columns on the estimated organic carbon, the
standard error of the estimate, and the type of model used to estimate
the organic carbon value in that sample; and [2] a list of the models
estimated, for further inspection.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">oc_out</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="3%">
<col width="5%">
<col width="5%">
<col width="11%">
<col width="6%">
<col width="2%">
<col width="2%">
<col width="5%">
<col width="5%">
<col width="1%">
<col width="2%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="5%">
<col width="5%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left">site</th>
<th align="left">core</th>
<th align="left">ecosystem</th>
<th align="left">species</th>
<th align="right">compaction</th>
<th align="right">mind</th>
<th align="right">maxd</th>
<th align="right">dbd</th>
<th align="right">om</th>
<th align="right">oc</th>
<th align="right">age</th>
<th align="right">mind_corrected</th>
<th align="right">maxd_corrected</th>
<th align="right">dbd_corrected</th>
<th align="right">eoc</th>
<th align="right">eoc_se</th>
<th align="left">origin</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.7352912</td>
<td align="right">6.554328</td>
<td align="right">NA</td>
<td align="right">8</td>
<td align="right">0.000000</td>
<td align="right">1.060606</td>
<td align="right">0.6932745</td>
<td align="right">2.296034</td>
<td align="right">0.0458514</td>
<td align="left">Model by species</td>
</tr>
<tr class="even">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0.9754336</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">13</td>
<td align="right">1.060606</td>
<td align="right">2.121212</td>
<td align="right">0.9196945</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0.8698411</td>
<td align="right">7.382634</td>
<td align="right">NA</td>
<td align="right">15</td>
<td align="right">2.121212</td>
<td align="right">3.181818</td>
<td align="right">0.8201359</td>
<td align="right">2.566545</td>
<td align="right">0.0516612</td>
<td align="left">Model by species</td>
</tr>
<tr class="even">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">1.0272564</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">22</td>
<td align="right">3.181818</td>
<td align="right">4.242424</td>
<td align="right">0.9685560</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">0.9307887</td>
<td align="right">8.026647</td>
<td align="right">NA</td>
<td align="right">29</td>
<td align="right">4.242424</td>
<td align="right">5.303030</td>
<td align="right">0.8776007</td>
<td align="right">2.775515</td>
<td align="right">0.0559117</td>
<td align="left">Model by species</td>
</tr>
<tr class="even">
<td align="left">Sg_01</td>
<td align="left">Sg_01_01</td>
<td align="left">Seagrass</td>
<td align="left">Posidonia oceanica</td>
<td align="right">5.714286</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="right">1.4696196</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">35</td>
<td align="right">5.303030</td>
<td align="right">6.363636</td>
<td align="right">1.3856413</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">oc_out</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Mangrove</span></span>
<span><span class="co">#&gt; $Mangrove$ecosystem_model</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Mangrove$multispecies_model</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Mangrove$site_models</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Salt Marsh`</span></span>
<span><span class="co">#&gt; $`Salt Marsh`$ecosystem_model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = log(oc_r) ~ log(om_r), data = df)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)    log(om_r)  </span></span>
<span><span class="co">#&gt;      -1.667        1.077  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Salt Marsh`$multispecies_model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = log(oc_r) ~ log(om_r) * species_r, data = df)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                          (Intercept)                             log(om_r)  </span></span>
<span><span class="co">#&gt;                              -1.9154                                1.1678  </span></span>
<span><span class="co">#&gt;           species_rSpartina maritima  log(om_r):species_rSpartina maritima  </span></span>
<span><span class="co">#&gt;                               1.0662                               -0.4614  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Salt Marsh`$site_models</span></span>
<span><span class="co">#&gt; $`Salt Marsh`$site_models$Sm_01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = log(oc_r) ~ log(om_r), data = df)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)    log(om_r)  </span></span>
<span><span class="co">#&gt;     -0.8492       0.7064  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Salt Marsh`$site_models$Sm_02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = log(oc_r) ~ log(om_r), data = df)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)    log(om_r)  </span></span>
<span><span class="co">#&gt;      -2.281        1.484  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Salt Marsh`$site_models$Sm_03</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = log(oc_r) ~ log(om_r), data = df)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)    log(om_r)  </span></span>
<span><span class="co">#&gt;      -1.892        1.121</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimation-of-organic-carbon-stocks-at-1m-and-75-cm-depth">Estimation of organic carbon stocks at 1m and 75 cm depth<a class="anchor" aria-label="anchor" href="#estimation-of-organic-carbon-stocks-at-1m-and-75-cm-depth"></a>
</h2>
<p>The organic carbon stock is the accumulated organic carbon mass until
a provided depth per unit area. The default depth of function
<code><a href="../reference/estimate_oc_stock.html">estimate_oc_stock()</a></code> is 100. If the depth of the samples is
provided in cm (as in the example data) this will correspond with 1
meter. If the core does not reach the desired depth (standardization
depth), it extrapolates the stock to that depth from a linear model
between accumulated mass of organic carbon and depth.</p>
<p>The organic carbon mass of each sample is estimated as:</p>
<p>OC=DBD*(OCp/100)*h (Equation 1)</p>
<p>where DBD is the dry bulk density, OCp the organic carbon content in
percentage and h the thickness of the sample (maximum depth of the
sample - minimum depth of the sample).</p>
<p>It is common to analyze only selected samples of a core to reduce
workload and analytic costs. Therefore, it is necessary to estimate the
organic carbon mass in the spaces between samples to estimate the
accumulated organic carbon mass. The function <code><a href="../reference/estimate_h.html">estimate_h()</a></code>
distributes these empty spaces between the adjacent samples. This allows
to account for both different sample thickness and different spacing
between samples. Then, the organic carbon mass of that sample will be
estimated following equation 1 with the corrected sample thickness.</p>
<div class="float">
<img src="images/estimate_h().png" width="401" alt="Distribution of empty spaces between samples by estimate_h() function"><div class="figcaption">Distribution of empty spaces between samples by
estimate_h() function</div>
</div>
<p>The function <code><a href="../reference/estimate_h.html">estimate_h()</a></code> is already incorporated within
functions <code><a href="../reference/estimate_oc_stock.html">estimate_oc_stock()</a></code>,
<code><a href="../reference/test_extrapolation.html">test_extrapolation()</a></code> and <code><a href="../reference/estimate_seq_rate.html">estimate_seq_rate()</a></code>,
and there is no need to run it beforehand.</p>
<p>function <code><a href="../reference/estimate_oc_stock.html">estimate_oc_stock()</a></code> has 7 parameters:</p>
<ul>
<li><p>“df”: A data.frame with core (core id), mind (minimum depth of
the sample), maxd (maximum depth of the sample), dbd (dry bulk density),
oc (organic carbon %)</p></li>
<li><p>“depth”: Numeric Maximum depth to estimate the stock, by default
100.</p></li>
<li><p>“core”: Character Name of the column reporting core ID.</p></li>
<li><p>“mind”: Character Name of the column reporting the minimum depth
of each sample.</p></li>
<li><p>“maxd”: Character Name of the column reporting the maximum depth
of each sample.</p></li>
<li><p>“dbd”: Character Name of the column reporting dry bulk
density.</p></li>
<li><p>“oc”: Character Name of the column reporting organic carbon
concentrations.</p></li>
</ul>
<p>We used the output from <code><a href="../reference/estimate_oc.html">estimate_oc()</a></code> to estimate the
organic carbon stock per cm<sup>2</sup> up to 1m depth. As the column
names from the <code><a href="../reference/estimate_oc.html">estimate_oc()</a></code> output are the same as the
default names in <code><a href="../reference/estimate_oc_stock.html">estimate_oc_stock()</a></code> we don’t need to
specify them. Furthermore, the default depth is 100, and our data is in
cm so we don’t need to specify the depth (i.e. will estimate carbon
stock down to 1m depth).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stocks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_oc_stock.html">estimate_oc_stock</a></span><span class="op">(</span><span class="va">oc_out</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>The output of this function is a dataframe with 5 columns. The first
column is the core ID. The second column (<code>stockwc</code>) is the
carbon stock in the whole core. The third column is the maximum depth of
that core. The fourth column is the stock down to the standardization
depth. Finally, if the core didn’t reach the standardization depth, we
will get a value in the fifth column with the standard error of the
accumulated mass-depth model used to estimate the stock.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stocks</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;        core    stockwc      maxd     stock    stock_se</span></span>
<span><span class="co">#&gt; 1  Sg_01_01 2.62947377 156.96970 1.8551331          NA</span></span>
<span><span class="co">#&gt; 2  Sg_01_02 2.37997169  78.34839 2.9938578 0.092740541</span></span>
<span><span class="co">#&gt; 3  Sg_01_03 2.08002346  99.63509 2.1763784 0.069382436</span></span>
<span><span class="co">#&gt; 4  Sg_02_01 2.06631095 124.21053 1.6774846          NA</span></span>
<span><span class="co">#&gt; 5  Sg_02_02 0.06798487  23.14286 0.3099306 0.015373325</span></span>
<span><span class="co">#&gt; 6  Sg_02_03 0.93076430  55.82951 1.6394040 0.055765031</span></span>
<span><span class="co">#&gt; 7  Sg_03_01 0.17284439  48.04054 0.3532540 0.007802834</span></span>
<span><span class="co">#&gt; 8  Sg_03_02 0.19106567  35.80000 0.5485867 0.021102396</span></span>
<span><span class="co">#&gt; 9  Sg_03_03 0.17326199  60.76078 0.3048915 0.021924873</span></span>
<span><span class="co">#&gt; 10 Sg_04_01 0.97516409  95.60894 1.1414566 0.055859866</span></span></code></pre></div>
<p>The stock units are mass/area to a depth (length). The actual units
will depend on those provided in the original dataframe. In the example
data (<code>bluecarbon_data</code>), the carbon mass will be in g and
the area cm<sup>-2</sup> (as the dry bulk density was in
g/cm<sup>-3</sup>) and the depth will be 100 cm, as the minimum and
maximum depth of the samples was in cm. So the units for the estimated
carbon stock in this case are <strong>g/cm<sup>-2</sup> in the top 100
cm</strong>.</p>
<p>To estimate the stock to a depth different than 100 cm, we have to
specify it in the parameter “depth”. For example, to estimate the carbon
stock down to 75 cm:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stocks75</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_oc_stock.html">estimate_oc_stock</a></span><span class="op">(</span><span class="va">oc_out</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, depth <span class="op">=</span> <span class="fl">75</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stocks75</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;        core    stockwc      maxd     stock    stock_se</span></span>
<span><span class="co">#&gt; 1  Sg_01_01 2.62947377 156.96970 1.5957092          NA</span></span>
<span><span class="co">#&gt; 2  Sg_01_02 2.37997169  78.34839 2.2059969          NA</span></span>
<span><span class="co">#&gt; 3  Sg_01_03 2.08002346  99.63509 1.7547894          NA</span></span>
<span><span class="co">#&gt; 4  Sg_02_01 2.06631095 124.21053 1.3186908          NA</span></span>
<span><span class="co">#&gt; 5  Sg_02_02 0.06798487  23.14286 0.2306065 0.011009091</span></span>
<span><span class="co">#&gt; 6  Sg_02_03 0.93076430  55.82951 1.2240241 0.038709351</span></span>
<span><span class="co">#&gt; 7  Sg_03_01 0.17284439  48.04054 0.2721119 0.005376076</span></span>
<span><span class="co">#&gt; 8  Sg_03_02 0.19106567  35.80000 0.4083799 0.014856354</span></span>
<span><span class="co">#&gt; 9  Sg_03_03 0.17326199  60.76078 0.2292955 0.015143971</span></span>
<span><span class="co">#&gt; 10 Sg_04_01 0.97516409  95.60894 0.9352101          NA</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="test-stock-extrapolation">Test stock extrapolation<a class="anchor" aria-label="anchor" href="#test-stock-extrapolation"></a>
</h2>
<p>With this function (<code><a href="../reference/test_extrapolation.html">test_extrapolation()</a></code>) we can
visualize the amount of error that may be introduced by extrapolating
carbon stocks of short cores to a deeper standardization depth. This
function uses those cores that reach the desired depth and tests what
would be the error in the estimated carbon stock if we were to model it
from the 90, 75, 50 and 25% of that depth. This function subsets the
cores that reach the desired depth, estimates the complete stock
(observed stock) to indicated desired depth, estimates the stock from
the linear relation of organic carbon accumulated mass and depth using
the 90, 75, 50 and 25% length of the indicated desired depth, and
compares the observed stock with the stocks estimated by extrapolation.
IT DOES NOT provide the error for those cores modeled by the function
<code><a href="../reference/estimate_oc_stock.html">estimate_oc_stock()</a></code> as that function models those cores
that do not reach the desired depth. This function requires that some of
your cores do reach the desired depth.</p>
<p>function <code><a href="../reference/test_extrapolation.html">test_extrapolation()</a></code> has 7 parameters:</p>
<ul>
<li><p>“df”: A data.frame with core (core id), mind (minimum depth of
the sample), maxd (maximum depth of the sample), dbd (dry bulk density),
oc (organic carbon %)</p></li>
<li><p>“depth”: Numeric Maximum depth to estimate the stock, by default
100.</p></li>
<li><p>“core”: Character Name of the column reporting core ID.</p></li>
<li><p>“mind”: Character Name of the column reporting the minimum depth
of each sample.</p></li>
<li><p>“maxd”: Character Name of the column reporting the maximum depth
of each sample.</p></li>
<li><p>“dbd”: Character Name of the column reporting dry bulk
density.</p></li>
<li><p>“oc”: Character Name of the column reporting organic carbon
concentrations.</p></li>
</ul>
<p>As in the <code><a href="../reference/estimate_oc_stock.html">estimate_oc_stock()</a></code> example, we used the
output from <code><a href="../reference/estimate_oc.html">estimate_oc()</a></code> to estimate the organic carbon
stock per cm<sup>2</sup> up to 1m depth. As the column names from the
<code><a href="../reference/estimate_oc.html">estimate_oc()</a></code> output are the same as the default names in
<code><a href="../reference/estimate_oc_stock.html">estimate_oc_stock()</a></code> we don’t need to specify them.
Furthermore, the default depth is 100, and our data is in cm so we don’t
need to specify the depth.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stocks_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/test_extrapolation.html">test_extrapolation</a></span><span class="op">(</span><span class="va">oc_out</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_boxplot()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>This function returns a dataframe with observed and extrapolated
stocks, and two plots. The first plot (left) shows the deviation of the
extrapolated stock from the observed stock, in percentage of the
observed stock. The second plot (right) shows the distribution of the
extrapolated and observed stocks. The diagonal line indicate that both
stocks are equal. Above that line, the extrapolated stock was
overestimated; below the line, the extrapolated stock was
underestimated.</p>
<p>The same can be done for a different depth. Like in the example of
<code><a href="../reference/estimate_oc_stock.html">estimate_oc_stock()</a></code> we use 75 by modifying the parameter
“depth”.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stocks_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/test_extrapolation.html">test_extrapolation</a></span><span class="op">(</span><span class="va">oc_out</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, depth <span class="op">=</span> <span class="fl">75</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 5 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_boxplot()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 5 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="estimate-soil-organic-carbon-sequestration-rates">Estimate soil organic carbon sequestration rates<a class="anchor" aria-label="anchor" href="#estimate-soil-organic-carbon-sequestration-rates"></a>
</h2>
<p>In depositional environments, like seagrass meadows, salt marshes and
mangroves forests, it is possible to estimate the sediment accretion
rate of the cores, as long as the sedimentary record has not been mixed.
<code><a href="../reference/estimate_seq_rate.html">estimate_seq_rate()</a></code> estimates the organic carbon
sequestration rates of those cores that have a coherent age-depth model.
The information of the model is included as the age of the sample in a
column of the dataframe (column “age” in the example dataframe). The
function will select those samples that have age data and delete those
without.</p>
<p>Estimations of organic carbon sequestration rates depend on the
balance between organic matter burial and degradation. Therefore, the
longer the time frame used to estimate the average sequestration rate,
the lower the estimated sequestration rate. To be able to compare among
cores, all sequestration rates must be standardized to the same time
frame.</p>
<p>The function <code><a href="../reference/estimate_seq_rate.html">estimate_seq_rate()</a></code> estimates the average
carbon sequestration rates for a known time frame (100 by default) by
summing the carbon stocks down to that age-depth and dividing by the
time frame. The timeframe always refers to the last period of time (the
last 100, the last 1000, etc…)</p>
<p><code><a href="../reference/estimate_seq_rate.html">estimate_seq_rate()</a></code> has 8 parameters:</p>
<ul>
<li><p>“df”: A data.frame with, at least, columns: core, mind (minimum
depth of the sample), maxd (maximum depth of the sample), dbd (dry bulk
density), oc (organic carbon %), age (age of the sample obtained from a
age-depth or age-accumulated mass model)</p></li>
<li><p>“timeframe”: Numeric Standardization time frame, by default 100
years</p></li>
<li><p>“core”: Character Name of the column reporting core ID.</p></li>
<li><p>“mind”: Character Name of the column reporting the minimum depth
of each sample.</p></li>
<li><p>“maxd”: Character Name of the column reporting the maximum depth
of each sample.</p></li>
<li><p>“dbd”: Character Name of the column reporting dry bulk
density.</p></li>
<li><p>“oc”: Character Name of the column reporting organic carbon
concentrations.</p></li>
<li><p>“age”: Character Name of the column reporting the age of each
sample.</p></li>
</ul>
<p>We use the output from <code><a href="../reference/estimate_oc.html">estimate_oc()</a></code> to estimate the
organic carbon sequestration rate per cm<sup>2</sup> in the last 100
years. As the column names from the <code><a href="../reference/estimate_oc.html">estimate_oc()</a></code> output
are the same as the default names in <code><a href="../reference/estimate_seq_rate.html">estimate_seq_rate()</a></code> we
don’t need to specify them. Furthermore, the default time frame is
100.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seq_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_seq_rate.html">estimate_seq_rate</a></span><span class="op">(</span><span class="va">oc_out</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>The output of this function is a dataframe with 4 columns. The first
column is the core ID. The second column is the average sequestration
rate in the whole core. The third column is the maximum age of that
core. The fourth column is the sequestration rate in the provided time
frame.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">seq_rate</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;        core  seq_rate_wc  maxage     seq_rate</span></span>
<span><span class="co">#&gt; 1  Sg_01_01 0.0020180152 1303.00 0.0043626875</span></span>
<span><span class="co">#&gt; 2  Sg_02_01 0.0005423388 3810.00 0.0027556600</span></span>
<span><span class="co">#&gt; 3  Sg_03_01 0.0001068260 1618.00 0.0002322665</span></span>
<span><span class="co">#&gt; 4  Sg_05_01 0.0023649409  422.00 0.0022770729</span></span>
<span><span class="co">#&gt; 5  Mg_01_01 0.0024467131  990.00 0.0040171986</span></span>
<span><span class="co">#&gt; 6  Sm_01_01 0.0009239537 1247.00 0.0012018703</span></span>
<span><span class="co">#&gt; 7  Sm_02_01 0.0003773279 3096.00 0.0013587956</span></span>
<span><span class="co">#&gt; 8  Sm_03_01 0.0012985371  592.00 0.0025806030</span></span>
<span><span class="co">#&gt; 9  Sg_06_01 0.0080307101  164.15 0.0069686883</span></span>
<span><span class="co">#&gt; 10 Sg_06_02 0.0021769458  776.50 0.0045876577</span></span></code></pre></div>
<p>The sequestration rates units are mass/area by time (in the last xxx
units of time). The units will be those provided in the dataframe. In
the example data, mass will be g and the area cm<sup>-2</sup> (as the
dry bulk density was in g/cm<sup>-3</sup>) and both times will be in
years, as the age of the samples was in years. So, the sequestration
rates units in this example are <strong>g/cm<sup>-2</sup>
yr<sup>-1</sup> in the last 100 years</strong>.</p>
<p>To estimate the organic carbon sequestration rate in a different
timeframe than 100, we have to specify it in the parameter
“timeframe”.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seq_rate_200</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_seq_rate.html">estimate_seq_rate</a></span><span class="op">(</span><span class="va">oc_out</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, timeframe <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co">#&gt; Core Sg_06_01 is younger than the time frame provided</span></span>
<span><span class="co">#&gt; Core Sm_07_01 is younger than the time frame provided</span></span>
<span><span class="co">#&gt; Core Mg_02_01 is younger than the time frame provided</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">seq_rate_200</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;        core  seq_rate_wc  maxage     seq_rate</span></span>
<span><span class="co">#&gt; 1  Sg_01_01 0.0020180152 1303.00 0.0036333524</span></span>
<span><span class="co">#&gt; 2  Sg_02_01 0.0005423388 3810.00 0.0017522040</span></span>
<span><span class="co">#&gt; 3  Sg_03_01 0.0001068260 1618.00 0.0001802125</span></span>
<span><span class="co">#&gt; 4  Sg_05_01 0.0023649409  422.00 0.0024636800</span></span>
<span><span class="co">#&gt; 5  Mg_01_01 0.0024467131  990.00 0.0027250712</span></span>
<span><span class="co">#&gt; 6  Sm_01_01 0.0009239537 1247.00 0.0010274819</span></span>
<span><span class="co">#&gt; 7  Sm_02_01 0.0003773279 3096.00 0.0007817402</span></span>
<span><span class="co">#&gt; 8  Sm_03_01 0.0012985371  592.00 0.0015549084</span></span>
<span><span class="co">#&gt; 9  Sg_06_01 0.0080307101  164.15           NA</span></span>
<span><span class="co">#&gt; 10 Sg_06_02 0.0021769458  776.50 0.0037439774</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nerea Piñeiro-Juncal, Julen Astigarraga, Valentina Costa, Marcio Martins, Francisco Rodriguez-Sanchez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
