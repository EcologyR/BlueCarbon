<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimation of Organic Carbon Stocks and Sequestration Rates from Soil Core Data • BlueCarbon</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Estimation of Organic Carbon Stocks and Sequestration Rates from Soil Core Data">
<meta name="description" content="Tools to estimate soil organic carbon stocks and sequestration rates in blue carbon ecosystems. BlueCarbon contains functions to estimate and correct for core compaction, estimate sample thickness, estimate organic carbon content from organic matter content, estimate organic carbon stocks and sequestration rates, and visualize the error of carbon stock extrapolation.">
<meta property="og:description" content="Tools to estimate soil organic carbon stocks and sequestration rates in blue carbon ecosystems. BlueCarbon contains functions to estimate and correct for core compaction, estimate sample thickness, estimate organic carbon content from organic matter content, estimate organic carbon stocks and sequestration rates, and visualize the error of carbon stock extrapolation.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">BlueCarbon</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/Tutorial.html">Tutorial</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EcologyR/BlueCarbon/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="bluecarbon">BlueCarbon<a class="anchor" aria-label="anchor" href="#bluecarbon"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<p>The goal of BlueCarbon is to facilitate the estimation of organic carbon stocks and sequestration rates from soil/sediment cores from blue carbon ecosystems.</p>
<p>It contains seven main functions to deal with core compaction (estimate the compaction of cores and mathematically correct core compaction), transform laboratory data (estimate sample thickness and estimate organic carbon content from organic matter content) and estimate organic carbon stocks and sequestration rates (estimate organic carbon stocks and sequestration rates and visualize the error of stock extrapolation).</p>
<figure><img src="reference/figures/BC_workflow.png" alt="BlueCarbon library workflow"><figcaption aria-hidden="true">
BlueCarbon library workflow
</figcaption></figure><div class="section level4">
<h4 id="estimate_compaction---estimate-core-compaction">
<strong><em>estimate_compaction</em></strong> <strong>- Estimate Core Compaction</strong>
<a class="anchor" aria-label="anchor" href="#estimate_compaction---estimate-core-compaction"></a>
</h4>
<p>Sampling soil cores by manual percussion usually leads to the compaction of the material retrieved. This function will estimate the percentage of compaction from measurements taken in the field after inserting the corer tube and before extracting it: length of the corer tube (sampler_length), distance between the surface of the soil and the top of the tube in the outside (external_distance) and distance between the surface of the soil and the top of the tube in the inside of the tube (internal_distance).</p>
<figure><img src="reference/figures/compaction.png" width="339" alt="Soil compaction from field sampling"><figcaption aria-hidden="true">
Soil compaction from field sampling
</figcaption></figure>
</div>
<div class="section level4">
<h4 id="decompact---calculate-sediment-properties-after-decompaction">
<strong><em>decompact</em></strong> <strong>- Calculate sediment properties after decompaction</strong>
<a class="anchor" aria-label="anchor" href="#decompact---calculate-sediment-properties-after-decompaction"></a>
</h4>
<p>Core compaction derived from field extraction can be mathematically correct to estimate the original depth of the samples. This function will apply a linear correction (all the core material is assumed to have been compacted equally) to correct sample depth and, if provided, dry bulk density.</p>
</div>
<div class="section level4">
<h4 id="estimate_oc---organic-carbon-content-estimation-from-organic-carbon-data">
<strong><em>estimate_oc</em></strong> <strong>- Organic carbon content estimation from organic carbon data</strong>
<a class="anchor" aria-label="anchor" href="#estimate_oc---organic-carbon-content-estimation-from-organic-carbon-data"></a>
</h4>
<p>There is linear correlation between organic carbon and organic matter content. This correlation can change between ecosystems and sampling sites due to changes in organic matter composition among other factors. This function model a linear correlation between organic matter and organic carbon content in your samples and predict the content of organic carbon for those samples were there is no organic carbon values. Estimation of organic carbon is done by means of linear regressions on log(organic carbon) ~ log(organic matter). It gives back a organic carbon value for each organic matter value provided. If there is a organic carbon value for that sample it return the same value, else, generates a model for that site, else, model for specie, else, model for that ecosystem. If a model can not be created due to the low number of samples (&lt;10) it uses the equations in Fourqurean et al. 2012 for seagrasses, Maxwell et al. 2023 for salt marshes and Piñeiro-Juncal, in review, for mangroves to estimate the organic carbon. It is unlikely, but possible, that a model will predict a higher organic carbon than organic matter content. This is not possible in nature. If this is the case the function will give a warning and it is recommended to discard that model.</p>
<p>Fourqureanet al. (2012) Seagrass ecosystems as a globally significant carbon stock. Nat. Geosci.5, 505–509. <a href="https://doi.org/10.1038/ngeo1477" class="external-link uri">https://doi.org/10.1038/ngeo1477</a></p>
<p>Maxwell et al. (2023) Global dataset of soil organic carbon in tidal marshes.Sci.Data 10, 1–14.<a href="https://doi.org/10.1038/s41597-023-02633-x" class="external-link uri">https://doi.org/10.1038/s41597-023-02633-x</a></p>
<p>Piñeiro-Juncal et al. (in review) Soil organic carbon preservation and decay trends in tidal marsh, mangrove and seagrass blue carbon ecosystems.</p>
</div>
<div class="section level4">
<h4 id="estimate_h---sample-thickness-estimation">
<strong><em>estimate_h</em></strong> <strong>- Sample thickness estimation</strong>
<a class="anchor" aria-label="anchor" href="#estimate_h---sample-thickness-estimation"></a>
</h4>
<p>For those cores were only selected samples were measured it is necessary to assign a carbon density to the empty spaces before the estimation the total stock. This function checks for gaps between samples and, if any, divide this space between the previous and next sample to return sample thickness without gaps in the core. The middle point between one sample and the other is estimated from the bottom of the previous sample to the top of the next sample, and not form the middle point of one sample to the middle part of the next, as this would inequality distribute the gaps between samples if the samples have different thickness. The stock and sequestration rate estimation functions (estimate_oc_stock and estimate_seq_rate) have this function incorporated and it is not necessary to run it beforehand.</p>
<figure><img src="reference/figures/estimate_h().png" width="465" alt="Gap distribution between samples to estimate accumulated organic carbon mass."><figcaption aria-hidden="true">
Gap distribution between samples to estimate accumulated organic carbon mass.
</figcaption></figure>
</div>
<div class="section level4">
<h4 id="estimate_oc_stock---organic-carbon-stock-estimation">
<strong><em>estimate_oc_stock</em></strong> <strong>- Organic carbon stock estimation</strong>
<a class="anchor" aria-label="anchor" href="#estimate_oc_stock---organic-carbon-stock-estimation"></a>
</h4>
<p>Estimates carbon stocks from soil core data down to a specified depth, 100 cm by default. If the core does not reach the desired depth, it extrapolates the stock from a linear model between accumulated mass of organic carbon and depth.</p>
<figure><img src="reference/figures/estimate_stock.png" width="446" alt="OC stock estimation diagram"><figcaption aria-hidden="true">
OC stock estimation diagram
</figcaption></figure>
</div>
<div class="section level4">
<h4 id="test_extrapolation---visualize-the-error-of-stock-extrapolation">
<strong><em>test_extrapolation</em></strong> <strong>- Visualize the error of stock extrapolation</strong>
<a class="anchor" aria-label="anchor" href="#test_extrapolation---visualize-the-error-of-stock-extrapolation"></a>
</h4>
<p>This function subset those cores that reach the desired depth, estimates the stock (observed stock), estimate the stock from the linear relation of organic carbon accumulated mass and depth using the 90, 75, 50 and 25% top length of the indicated desired depth. Compares the observed stock with the estimated stocks by extrapolation. This function requires that some of you core do reach the desired depth.</p>
</div>
<div class="section level4">
<h4 id="estimate_seq_rate---organic-carbon-sequestration-rates-estimation">
<strong><em>estimate_seq_rate</em></strong> <strong>- Organic carbon sequestration rates estimation</strong>
<a class="anchor" aria-label="anchor" href="#estimate_seq_rate---organic-carbon-sequestration-rates-estimation"></a>
</h4>
<p>Estimate the average organic carbon sequestration rate to the soil in a indicated time frame (by default last 100 years) from the organic carbon concentration and the age of the samples.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>BlueCarbon can be installed directly from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"EcologyR/BlueCarbon"</span><span class="op">)</span></span></code></pre></div>
<p>or from R-universe:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BlueCarbon"</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://pakillo.r-universe.dev"</span>, <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If using this package, please cite it:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"BlueCarbon"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>To cite package <span class="st">'BlueCarbon'</span> <span class="cf">in</span> publications use<span class="sc">:</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  Piñeiro<span class="sc">-</span>Juncal N, Astigarraga J, Costa V, Martins M,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  Rodriguez<span class="sc">-</span>Sanchez <span class="fu">F</span> (<span class="dv">2024</span>). _BlueCarbon<span class="sc">:</span> Estimation of Organic Carbon</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  Stocks and Sequestration Rates From Soil Core Data_. R package</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  version <span class="dv">0</span>.<span class="fl">0.1</span>, https<span class="sc">:</span><span class="er">//</span>EcologyR.github.io<span class="sc">/</span>BlueCarbon<span class="sc">/</span>,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="sc">&lt;</span>https<span class="sc">:</span><span class="er">//</span>github.com<span class="sc">/</span>EcologyR<span class="sc">/</span>BlueCarbon<span class="sc">&gt;</span>.</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>A BibTeX entry <span class="cf">for</span> LaTeX users is</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  <span class="sc">@</span>Manual{,</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    title <span class="ot">=</span> {BlueCarbon<span class="sc">:</span> Estimation of Organic Carbon Stocks and Sequestration Rates From Soil Core Data},</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>    author <span class="ot">=</span> {Nerea Piñeiro<span class="sc">-</span>Juncal and Julen Astigarraga and Valentina Costa and Marcio Martins and Francisco Rodriguez<span class="sc">-</span>Sanchez},</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>    year <span class="ot">=</span> {<span class="dv">2024</span>},</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>    url <span class="ot">=</span> {https<span class="sc">:</span><span class="er">//</span>github.com<span class="sc">/</span>EcologyR<span class="sc">/</span>BlueCarbon},</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>    note <span class="ot">=</span> {R package version <span class="dv">0</span>.<span class="fl">0.1</span>, https<span class="sc">:</span><span class="er">//</span>EcologyR.github.io<span class="sc">/</span>BlueCarbon<span class="sc">/</span>},</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="funding">Funding<a class="anchor" aria-label="anchor" href="#funding"></a>
</h2>
<p>The development of this software has been funded by Fondo Europeo de Desarrollo Regional (FEDER) and Consejería de Transformación Económica, Industria, Conocimiento y Universidades of Junta de Andalucía (proyecto US-1381388 led by Francisco Rodríguez Sánchez, Universidad de Sevilla). NPJ was supported by a Juan de la Cierva fellowship (JDC2022-048342-I). JA acknowledges funding from the CLIMB-FOREST Horizon Europe Project (No 101059888) that was funded by the European Union.</p>
<p><img src="https://ecologyr.github.io/workshop/images/logos.png"></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/EcologyR/BlueCarbon/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/EcologyR/BlueCarbon/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing BlueCarbon</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Nerea Piñeiro-Juncal <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0003-3767-1812" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Julen Astigarraga <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-9520-3713" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Valentina Costa <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-1513-0284" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Marcio Martins <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-6969-2215" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Francisco Rodriguez-Sanchez <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-7981-1599" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/EcologyR/BlueCarbon/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/EcologyR/BlueCarbon/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/EcologyR/BlueCarbon" class="external-link"><img src="https://codecov.io/gh/EcologyR/BlueCarbon/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg"></a></li>
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active - The project has reached a stable, usable state and is being actively developed."></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nerea Piñeiro-Juncal, Julen Astigarraga, Valentina Costa, Marcio Martins, Francisco Rodriguez-Sanchez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
