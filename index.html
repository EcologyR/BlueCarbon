<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimation of Organic Carbon Stocks and Sequestration Rates from Soil Core Data • BlueCarbon</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Estimation of Organic Carbon Stocks and Sequestration Rates from Soil Core Data">
<meta name="description" content="Tools to estimate soil organic carbon stocks and sequestration rates in blue carbon ecosystems. BlueCarbon contains functions to estimate and correct for core compaction, estimate sample thickness, estimate organic carbon content from organic matter content, estimate organic carbon stocks and sequestration rates, and visualize the error of carbon stock extrapolation.">
<meta property="og:description" content="Tools to estimate soil organic carbon stocks and sequestration rates in blue carbon ecosystems. BlueCarbon contains functions to estimate and correct for core compaction, estimate sample thickness, estimate organic carbon content from organic matter content, estimate organic carbon stocks and sequestration rates, and visualize the error of carbon stock extrapolation.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">BlueCarbon</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/Tutorial.html">Tutorial</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EcologyR/BlueCarbon/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="bluecarbon">BlueCarbon<a class="anchor" aria-label="anchor" href="#bluecarbon"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<p>The goal of BlueCarbon is to facilitate the estimation of organic carbon stocks and sequestration rates from soil/sediment cores from blue carbon ecosystems.</p>
<p>It includes seven main <a href="https://ecologyr.github.io/BlueCarbon/reference/index.html">functions</a> to (1) estimate core compaction, (2) correct core compaction, (3) estimate sample thickness, (4) estimate organic carbon content from organic matter content, (5) estimate organic carbon stocks and (6) sequestration rates, and (7) visualize the error in stock extrapolation.</p>
<figure><img src="reference/figures/BC_workflow.png" width="569" alt="Blue Carbon package workflow"><figcaption aria-hidden="true">
Blue Carbon package workflow
</figcaption></figure><div class="section level4">
<h4 id="estimate_compaction---estimate-core-compaction">
<strong><em>estimate_compaction</em></strong> <strong>- Estimate Core Compaction</strong>
<a class="anchor" aria-label="anchor" href="#estimate_compaction---estimate-core-compaction"></a>
</h4>
<p>Sampling soil cores by manual percussion often results in the compaction of the material retrieved. This function (<code><a href="reference/estimate_compaction.html">estimate_compaction()</a></code>) estimates the percentage of compaction using measurements taken before and after inserting the corer tube (Fig. 2): the length of the corer tube (sampler_length), distance between the surface of the soil and the top of the tube in the outside (external_distance) and distance between the surface of the soil and the top of the tube in the inside of the tube (internal_distance).</p>
<figure><img src="reference/figures/compaction.png" width="364" alt="Soil compaction from field sampling"><figcaption aria-hidden="true">
Soil compaction from field sampling
</figcaption></figure>
</div>
<div class="section level4">
<h4 id="decompact---calculate-sediment-properties-after-decompaction">
<strong><em>decompact</em></strong> <strong>- Calculate sediment properties after decompaction</strong>
<a class="anchor" aria-label="anchor" href="#decompact---calculate-sediment-properties-after-decompaction"></a>
</h4>
<p>Core compaction derived from field extraction can be mathematically corrected to estimate the original depth of the samples. This function (<code><a href="reference/decompact.html">decompact()</a></code>) applies a linear correction (assuming uniform compaction of the core material) to adjust the sample depth accurately. If dry bulk density data is provided, the function also corrects it accordingly.</p>
</div>
<div class="section level4">
<h4 id="estimate_oc---organic-carbon-content-estimation-from-organic-carbon-data">
<strong><em>estimate_oc</em></strong> <strong>- Organic carbon content estimation from organic carbon data</strong>
<a class="anchor" aria-label="anchor" href="#estimate_oc---organic-carbon-content-estimation-from-organic-carbon-data"></a>
</h4>
<p>There is a linear correlation between organic carbon and organic matter content. This correlation can vary across ecosystems and sampling sites. This function (<code><a href="reference/estimate_oc.html">estimate_oc()</a></code>) fits a linear regression model between organic matter and organic carbon content of the samples and predicts organic carbon values for samples where the latter information is missing. Estimation of organic carbon is performed using a linear regression between the logarithm of the organic carbon content and the logarithm of the organic matter content (log(organic carbon) \ log(organic matter)), providing an organic carbon value for each organic matter value. It fits a model for each sampling station, dominant species, and ecosystem. If an organic carbon value is already available for a sample, the function returns it. Otherwise, it applies the model for the corresponding sampling station. If a model cannot be fitted for that station (e.g. because of limited sample size) or if the model fit is poor, the function instead applies the model for the dominant species. If no suitable species-level model exists, it then applies the ecosystem-level model. If no models are available at any of these levels, the function defaults to published models: <a href="https://doi.org/10.1038/ngeo1477" class="external-link">Fourqurean et al. (2012)</a> for seagrasses, <a href="https://doi.org/10.1038/s41597-023-02633-x" class="external-link">Maxwell et al. (2023)</a> for salt marshes, and Piñeiro-Juncal et al. for mangroves. It is unlikely, but possible, that the model predicts higher organic carbon than organic matter content. If this occurs, the function issues a warning, and it is recommended to discard that model.</p>
</div>
<div class="section level4">
<h4 id="estimate_h---sample-thickness-estimation">
<strong><em>estimate_h</em></strong> <strong>- Sample thickness estimation</strong>
<a class="anchor" aria-label="anchor" href="#estimate_h---sample-thickness-estimation"></a>
</h4>
<p>For cores where only selected samples were measured, it is necessary to assign a carbon density to the unmeasured sections before estimating the total stock. This function (<code><a href="reference/estimate_h.html">estimate_h()</a></code>) identifies gaps between samples and, if any are present, divides the space between the previous and next sample, ensuring continuous samples without gaps in the core (Fig. 3). The midpoint between two consecutive samples is estimated from the bottom of the previous sample to the top of the next sample, preventing the uneven distribution of gaps between samples with different thickness. The stock and sequestration rate estimation functions (<code><a href="reference/estimate_oc_stock.html">estimate_oc_stock()</a></code> and <code><a href="reference/estimate_seq_rate.html">estimate_seq_rate()</a></code>) already incorporate this function, so there is no need to run it separately.</p>
<figure><img src="reference/figures/estimate_h.png" width="365" alt="Gap distribution between samples to estimate accumulated organic carbon mass"><figcaption aria-hidden="true">
Gap distribution between samples to estimate accumulated organic carbon mass
</figcaption></figure>
</div>
<div class="section level4">
<h4 id="estimate_oc_stock---organic-carbon-stock-estimation">
<strong><em>estimate_oc_stock</em></strong> <strong>- Organic carbon stock estimation</strong>
<a class="anchor" aria-label="anchor" href="#estimate_oc_stock---organic-carbon-stock-estimation"></a>
</h4>
<p>Estimates carbon stocks from soil core data down to a specified depth, with 100 as the default. If the core does not reach the desired depth, the function extrapolates the stock using a linear model based on the relationship between accumulated organic carbon mass and depth. In this model, accumulated organic carbon mass (stock) is the target variable and depth the explanatory variable (lm(accumulated organic carbon mass ~ depth)).</p>
<figure><img src="reference/figures/estimate_stock.png" width="380" alt="Organic carbon stock estimation diagram"><figcaption aria-hidden="true">
Organic carbon stock estimation diagram
</figcaption></figure>
</div>
<div class="section level4">
<h4 id="test_extrapolation---visualize-the-error-of-stock-extrapolation">
<strong><em>test_extrapolation</em></strong> <strong>- Visualize the error of stock extrapolation</strong>
<a class="anchor" aria-label="anchor" href="#test_extrapolation---visualize-the-error-of-stock-extrapolation"></a>
</h4>
<p>This function subset the cores that reach the desired depth, estimates the observed stock, and estimates the stock using the linear model on the relationship between accumulated organic carbon mass and depth. Extrapolations are performed using the top 90, 75, 50 and 25% length of the specified depth. The function then compares the observed stock with the extrapolated stock estimates. Note that this function requires that at least some cores reach the desired depth.</p>
</div>
<div class="section level4">
<h4 id="estimate_seq_rate---organic-carbon-sequestration-rates-estimation">
<strong><em>estimate_seq_rate</em></strong> <strong>- Organic carbon sequestration rates estimation</strong>
<a class="anchor" aria-label="anchor" href="#estimate_seq_rate---organic-carbon-sequestration-rates-estimation"></a>
</h4>
<p>Estimates the average organic carbon sequestration rate in the soil over a specified time frame (by default 100). The average sequestration rate is calculated by dividing the stock at the depth corresponding to the target time frame by the length of the time frame itself.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>BlueCarbon can be installed directly from <a href="https://cran.r-project.org/package=BlueCarbon" class="external-link">CRAN</a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BlueCarbon"</span><span class="op">)</span></span></code></pre></div>
<p>or from <a href="https://ecologyr.r-universe.dev/BlueCarbon" class="external-link">R-universe</a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BlueCarbon"</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://ecologyr.r-universe.dev"</span>, <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Or from <a href="https://github.com/EcologyR/BlueCarbon" class="external-link">GitHub</a>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"EcologyR/BlueCarbon"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If using this package, please cite it:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"BlueCarbon"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>To cite package <span class="st">'BlueCarbon'</span> <span class="cf">in</span> publications use<span class="sc">:</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  Piñeiro<span class="sc">-</span>Juncal N, Astigarraga J, Costa V, Martins M,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  Rodriguez<span class="sc">-</span>Sanchez <span class="fu">F</span> (<span class="dv">2025</span>). _BlueCarbon<span class="sc">:</span> Estimation of Organic Carbon</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  Stocks and Sequestration Rates From Soil Core Data_. R package</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  version <span class="dv">0</span>.<span class="fl">1.0</span>, https<span class="sc">:</span><span class="er">//</span>EcologyR.github.io<span class="sc">/</span>BlueCarbon<span class="sc">/</span>,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="sc">&lt;</span>https<span class="sc">:</span><span class="er">//</span>github.com<span class="sc">/</span>EcologyR<span class="sc">/</span>BlueCarbon<span class="sc">&gt;</span>.</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>A BibTeX entry <span class="cf">for</span> LaTeX users is</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  <span class="sc">@</span>Manual{,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    title <span class="ot">=</span> {BlueCarbon<span class="sc">:</span> Estimation of Organic Carbon Stocks and Sequestration Rates From Soil Core Data},</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>    author <span class="ot">=</span> {Nerea Piñeiro<span class="sc">-</span>Juncal and Julen Astigarraga and Valentina Costa and Marcio Martins and Francisco Rodriguez<span class="sc">-</span>Sanchez},</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>    year <span class="ot">=</span> {<span class="dv">2025</span>},</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>    url <span class="ot">=</span> {https<span class="sc">:</span><span class="er">//</span>github.com<span class="sc">/</span>EcologyR<span class="sc">/</span>BlueCarbon},</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>    note <span class="ot">=</span> {R package version <span class="dv">0</span>.<span class="fl">1.0</span>, https<span class="sc">:</span><span class="er">//</span>EcologyR.github.io<span class="sc">/</span>BlueCarbon<span class="sc">/</span>},</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the BlueCarbon project is released with a <a href="https://ecologyr.github.io/BlueCarbon/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
<div class="section level2">
<h2 id="funding">Funding<a class="anchor" aria-label="anchor" href="#funding"></a>
</h2>
<p>The development of this software has been funded by Fondo Europeo de Desarrollo Regional (FEDER) and Consejería de Transformación Económica, Industria, Conocimiento y Universidades of Junta de Andalucía (project US-1381388 led by Francisco Rodríguez Sánchez, Universidad de Sevilla). NPJ was supported by a Juan de la Cierva fellowship (JDC2022-048342-I, MCIN/AEI/10.13039/501100011033, European Union “NextGenerationEU”/PRTR”). JA acknowledges funding from the CLIMB-FOREST Horizon Europe Project (No 101059888) funded by the European Union. FRS was supported by VI PPIT-US from Universidad de Sevilla. MM was supported by a FCT PhD grant (<a href="https://doi.org/10.54499/2020.06996.BD" class="external-link uri">https://doi.org/10.54499/2020.06996.BD</a>).</p>
<p><img src="https://ecologyr.github.io/workshop/images/logos.png"></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=BlueCarbon" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/EcologyR/BlueCarbon/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/EcologyR/BlueCarbon/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing BlueCarbon</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Nerea Piñeiro-Juncal <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0003-3767-1812" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Julen Astigarraga <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-9520-3713" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Valentina Costa <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-1513-0284" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Marcio Martins <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-6969-2215" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Francisco Rodriguez-Sanchez <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-7981-1599" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=BlueCarbon" class="external-link"><img src="https://www.r-pkg.org/badges/version/BlueCarbon"></a></li>
<li><a href="https://github.com/EcologyR/BlueCarbon/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/EcologyR/BlueCarbon/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/EcologyR/BlueCarbon" class="external-link"><img src="https://codecov.io/gh/EcologyR/BlueCarbon/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg"></a></li>
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active - The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://cran.r-project.org/package=BlueCarbon" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/BlueCarbon"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nerea Piñeiro-Juncal, Julen Astigarraga, Valentina Costa, Marcio Martins, Francisco Rodriguez-Sanchez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
